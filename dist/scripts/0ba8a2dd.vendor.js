!function(a){function b(a){return a}function c(){}function d(a){return Math.floor(a/1e3)}function e(a){{var b=a.indexOf("|"),c=a.substring(0,b),d=c.lastIndexOf(","),e=c.lastIndexOf(",",d-1),f=c.lastIndexOf(",",e-1);1e3*c.substring(f+1,e),1e3*c.substring(d+1)}return a.substring(b+1).split(",").slice(1).map(function(a){return+a})}function f(a){if(!(a instanceof c))throw new Error("invalid context");this.context=a}function g(a,b){return function(c,d,e,f){a(new Date(+c+b),new Date(+d+b),e,f)}}function h(a,b){f.call(this,a),b=+b;var c=b+"";this.valueOf=function(){return b},this.toString=function(){return c}}function i(a,b){function c(b,c){if(c instanceof f){if(b.context!==c.context)throw new Error("mismatch context")}else c=new h(b.context,c);f.call(this,b.context),this.left=b,this.right=c,this.toString=function(){return b+" "+a+" "+c}}var d=c.prototype=Object.create(f.prototype);return d.valueAt=function(a){return b(this.left.valueAt(a),this.right.valueAt(a))},d.shift=function(a){return new c(this.left.shift(a),this.right.shift(a))},d.on=function(a,b){return arguments.length<2?this.left.on(a):(this.left.on(a,b),this.right.on(a,b),this)},function(a){return new c(this,a)}}function j(a){return 16777214&a}function k(a){return(a+1&16777214)-1}function l(a){a.style("position","absolute").style("top",0).style("bottom",0).style("width","1px").style("pointer-events","none")}function m(a){return a+"px"}var n=a.cubism={version:"1.2.2"},o=0;n.option=function(a,b){var c=n.options(a);return c.length?c[0]:b},n.options=function(a,b){for(var c,d=location.search.substring(1).split("&"),e=[],f=-1,g=d.length;++f<g;)(c=d[f].split("="))[0]==a&&e.push(decodeURIComponent(c[1]));return e.length||arguments.length<2?e:b},n.context=function(){function a(){var a=Date.now();return d=new Date(Math.floor((a-l-m)/j)*j),b=new Date(d-k*j),f=new Date(Math.floor((a-l)/j)*j),e=new Date(f-k*j),p.domain([b,d]),i}var b,d,e,f,g,h,i=new c,j=1e4,k=1440,l=5e3,m=5e3,n=d3.dispatch("prepare","beforechange","change","focus"),p=i.scale=d3.time.scale().range([0,k]);return i.start=function(){g&&clearTimeout(g);var a=+f+l-Date.now();return m>a&&(a+=j),g=setTimeout(function c(){f=new Date(Math.floor((Date.now()-l)/j)*j),e=new Date(f-k*j),n.prepare.call(i,e,f),setTimeout(function(){p.domain([b=e,d=f]),n.beforechange.call(i,e,f),n.change.call(i,e,f),n.focus.call(i,h)},m),g=setTimeout(c,j)},a),i},i.stop=function(){return g=clearTimeout(g),i},g=setTimeout(i.start,10),i.step=function(b){return arguments.length?(j=+b,a()):j},i.size=function(b){return arguments.length?(p.range([0,k=+b]),a()):k},i.serverDelay=function(b){return arguments.length?(l=+b,a()):l},i.clientDelay=function(b){return arguments.length?(m=+b,a()):m},i.focus=function(a){return n.focus.call(i,h=a),i},i.on=function(a,c){return arguments.length<2?n.on(a):(n.on(a,c),null!=c&&(/^prepare(\.|$)/.test(a)&&c.call(i,e,f),/^beforechange(\.|$)/.test(a)&&c.call(i,b,d),/^change(\.|$)/.test(a)&&c.call(i,b,d),/^focus(\.|$)/.test(a)&&c.call(i,h)),i)},d3.select(window).on("keydown.context-"+ ++o,function(){switch(!d3.event.metaKey&&d3.event.keyCode){case 37:null==h&&(h=k-1),h>0&&i.focus(--h);break;case 39:null==h&&(h=k-2),k-1>h&&i.focus(++h);break;default:return}d3.event.preventDefault()}),a()};var p=n.context.prototype=c.prototype;p.constant=function(a){return new h(this,+a)},p.cube=function(a){arguments.length||(a="");var b={},c=this;return b.metric=function(b){return c.metric(function(c,d,e,f){d3.json(a+"/1.0/metric?expression="+encodeURIComponent(b)+"&start="+q(c)+"&stop="+q(d)+"&step="+e,function(a){return a?void f(null,a.map(function(a){return a.value})):f(new Error("unable to load data"))})},b+="")},b.toString=function(){return a},b};var q=d3.time.format.iso;p.graphite=function(a){arguments.length||(a="");var b={},c=this;return b.metric=function(b){var f="sum",g=c.metric(function(c,g,h,i){var j=b;1e4!==h&&(j="summarize("+j+",'"+(h%36e5?h%6e4?h/1e3+"sec":h/6e4+"min":h/36e5+"hour")+"','"+f+"')"),d3.text(a+"/render?format=raw&target="+encodeURIComponent("alias("+j+",'')")+"&from="+d(c-2*h)+"&until="+d(g-1e3),function(a){return a?void i(null,e(a)):i(new Error("unable to load data"))})},b+="");return g.summarize=function(a){return f=a,g},g},b.find=function(b,c){d3.json(a+"/metrics/find?format=completer&query="+encodeURIComponent(b),function(a){return a?void c(null,a.metrics.map(function(a){return a.path})):c(new Error("unable to find metrics"))})},b.toString=function(){return a},b};var r=f.prototype;n.metric=f,r.valueAt=function(){return 0/0},r.alias=function(a){return this.toString=function(){return a},this},r.extent=function(){for(var a,b=0,c=this.context.size(),d=1/0,e=-1/0;++b<c;)a=this.valueAt(b),d>a&&(d=a),a>e&&(e=a);return[d,e]},r.on=function(){return arguments.length<2?null:this},r.shift=function(){return this},r.on=function(){return arguments.length<2?null:this},p.metric=function(a,b){function c(b,c){var d=Math.min(n,Math.round((b-l)/m));if(d&&!h){h=!0,d=Math.min(n,d+s);var e=new Date(c-d*m);a(e,c,m,function(a,b){if(h=!1,a)return console.warn(a);for(var d=isFinite(l)?Math.round((e-l)/m):0,f=0,g=b.length;g>f;++f)p[f+d]=b[f];q.change.call(j,l,c)})}}function d(a,b){isFinite(l)||(l=a),p.splice(0,Math.max(0,Math.min(n,Math.round((a-l)/m)))),l=a,e=b}var e,h,i=this,j=new f(i),k=".metric-"+ ++o,l=-1/0,m=i.step(),n=i.size(),p=[],q=d3.dispatch("change"),r=0;return j.valueAt=function(a){return p[a]},j.shift=function(b){return i.metric(g(a,+b))},j.on=function(a,b){return arguments.length?(null==b?null!=q.on(a)&&0==--r&&i.on("prepare"+k,null).on("beforechange"+k,null):null==q.on(a)&&1==++r&&i.on("prepare"+k,c).on("beforechange"+k,d),q.on(a,b),null!=b&&/^change(\.|$)/.test(a)&&b.call(i,l,e),j):q.on(a)},arguments.length>1&&(j.toString=function(){return b}),j};var s=6,t=h.prototype=Object.create(f.prototype);t.valueAt=function(){return+this},t.extent=function(){return[+this,+this]},r.add=i("+",function(a,b){return a+b}),r.subtract=i("-",function(a,b){return a-b}),r.multiply=i("*",function(a,b){return a*b}),r.divide=i("/",function(a,b){return a/b}),p.horizon=function(){function a(a){a.on("mousemove.horizon",function(){c.focus(Math.round(d3.mouse(this)[0]))}).on("mouseout.horizon",function(){c.focus(null)}),a.append("canvas").attr("width",f).attr("height",g),a.append("span").attr("class","title").text(k),a.append("span").attr("class","value"),a.each(function(a,k){function n(a){A.save();var b=v.extent();r=b.every(isFinite),null!=x&&(b=x);var i=0,j=Math.max(-b[0],b[1]);if(this===c){if(j==q){i=f-s;var k=(a-y)/z;if(f>k){var l=e.getContext("2d");l.clearRect(0,0,f,g),l.drawImage(A.canvas,k,0,f-k,g,0,0,f-k,g),A.clearRect(0,0,f,g),A.drawImage(l.canvas,0,0)}}y=a}h.domain([0,q=j]),A.clearRect(i,0,f-i,g);for(var m,n=0;C>n;++n){A.fillStyle=w[C+n];var o=(n-C+1)*g;h.range([C*g+o,o]),o=h(0);for(var p,t=i,u=f;u>t;++t)p=v.valueAt(t),0>=p?m=!0:A.fillRect(t,p=h(p),1,o-p)}if(m){"offset"===d&&(A.translate(0,g),A.scale(1,-1));for(var n=0;C>n;++n){A.fillStyle=w[C-1-n];var o=(n-C+1)*g;h.range([C*g+o,o]),o=h(0);for(var p,t=i,u=f;u>t;++t)p=v.valueAt(t),p>=0||A.fillRect(t,h(-p),1,o-h(-p))}}A.restore()}function p(a){null==a&&(a=f-1);var b=v.valueAt(a);B.datum(b).text(isNaN(b)?null:l)}var q,r,t=this,u=++o,v="function"==typeof i?i.call(t,a,k):i,w="function"==typeof m?m.call(t,a,k):m,x="function"==typeof j?j.call(t,a,k):j,y=-1/0,z=c.step(),A=d3.select(t).select("canvas"),B=d3.select(t).select(".value"),C=w.length>>1;A.datum({id:u,metric:v}),A=A.node().getContext("2d"),c.on("change.horizon-"+u,n),c.on("focus.horizon-"+u,p),v.on("change.horizon-"+u,function(a,c){n(a,c),p(),r&&v.on("change.horizon-"+u,b)})})}var c=this,d="offset",e=document.createElement("canvas"),f=e.width=c.size(),g=e.height=30,h=d3.scale.linear().interpolate(d3.interpolateRound),i=b,j=null,k=b,l=d3.format(".2s"),m=["#08519c","#3182bd","#6baed6","#bdd7e7","#bae4b3","#74c476","#31a354","#006d2c"];return a.remove=function(a){function b(a){a.metric.on("change.horizon-"+a.id,null),c.on("change.horizon-"+a.id,null),c.on("focus.horizon-"+a.id,null)}a.on("mousemove.horizon",null).on("mouseout.horizon",null),a.selectAll("canvas").each(b).remove(),a.selectAll(".title,.value").remove()},a.mode=function(b){return arguments.length?(d=b+"",a):d},a.height=function(b){return arguments.length?(e.height=g=+b,a):g},a.metric=function(b){return arguments.length?(i=b,a):i},a.scale=function(b){return arguments.length?(h=b,a):h},a.extent=function(b){return arguments.length?(j=b,a):j},a.title=function(b){return arguments.length?(k=b,a):k},a.format=function(b){return arguments.length?(l=b,a):l},a.colors=function(b){return arguments.length?(m=b,a):m},a},p.comparison=function(){function a(a){a.on("mousemove.comparison",function(){c.focus(Math.round(d3.mouse(this)[0]))}).on("mouseout.comparison",function(){c.focus(null)}),a.append("canvas").attr("width",d).attr("height",e),a.append("span").attr("class","title").text(l),a.append("span").attr("class","value primary"),a.append("span").attr("class","value change"),a.each(function(a,l){function r(a){B.save(),B.clearRect(0,0,d,e);var b=x.extent(),g=y.extent(),h=null==z?b:z;f.domain(h).range([e,0]),u=b.concat(g).every(isFinite);var i=a/c.step()&1?k:j;B.fillStyle=p[2];for(var l=0,m=d;m>l;++l){var n=f(x.valueAt(l)),o=f(y.valueAt(l));o>n&&B.fillRect(i(l),n,1,o-n)}for(B.fillStyle=p[0],l=0;m>l;++l){var n=f(x.valueAt(l)),o=f(y.valueAt(l));n>o&&B.fillRect(i(l),o,1,n-o)}for(B.fillStyle=p[3],l=0;m>l;++l){var n=f(x.valueAt(l)),o=f(y.valueAt(l));o>=n&&B.fillRect(i(l),n,1,q)}for(B.fillStyle=p[1],l=0;m>l;++l){var n=f(x.valueAt(l)),o=f(y.valueAt(l));n>o&&B.fillRect(i(l),n-q,1,q)}B.restore()}function s(a){null==a&&(a=d-1);var b=x.valueAt(a),c=y.valueAt(a),e=(b-c)/c;C.datum(b).text(isNaN(b)?null:m),D.datum(e).text(isNaN(e)?null:n).attr("class","value change "+(e>0?"positive":0>e?"negative":""))}function t(a,c){r(a,c),s(),u&&(x.on("change.comparison-"+w,b),y.on("change.comparison-"+w,b))}var u,v=this,w=++o,x="function"==typeof g?g.call(v,a,l):g,y="function"==typeof h?h.call(v,a,l):h,z="function"==typeof i?i.call(v,a,l):i,A=d3.select(v),B=A.select("canvas"),C=A.select(".value.primary"),D=A.select(".value.change");B.datum({id:w,primary:x,secondary:y}),B=B.node().getContext("2d"),x.on("change.comparison-"+w,t),y.on("change.comparison-"+w,t),c.on("change.comparison-"+w,r),c.on("focus.comparison-"+w,s)})}var c=this,d=c.size(),e=120,f=d3.scale.linear().interpolate(d3.interpolateRound),g=function(a){return a[0]},h=function(a){return a[1]},i=null,l=b,m=u,n=v,p=["#9ecae1","#225b84","#a1d99b","#22723a"],q=1.5;return a.remove=function(a){function b(a){a.primary.on("change.comparison-"+a.id,null),a.secondary.on("change.comparison-"+a.id,null),c.on("change.comparison-"+a.id,null),c.on("focus.comparison-"+a.id,null)}a.on("mousemove.comparison",null).on("mouseout.comparison",null),a.selectAll("canvas").each(b).remove(),a.selectAll(".title,.value").remove()},a.height=function(b){return arguments.length?(e=+b,a):e},a.primary=function(b){return arguments.length?(g=b,a):g},a.secondary=function(b){return arguments.length?(h=b,a):h},a.scale=function(b){return arguments.length?(f=b,a):f},a.extent=function(b){return arguments.length?(i=b,a):i},a.title=function(b){return arguments.length?(l=b,a):l},a.formatPrimary=function(b){return arguments.length?(m=b,a):m},a.formatChange=function(b){return arguments.length?(n=b,a):n},a.colors=function(b){return arguments.length?(p=b,a):p},a.strokeWidth=function(b){return arguments.length?(q=b,a):q},a};var u=d3.format(".2s"),v=d3.format("+.0%");p.axis=function(){function a(f){var g,h=++o,i=f.append("svg").datum({id:h}).attr("width",b.size()).attr("height",Math.max(28,-a.tickSize())).append("g").attr("transform","translate(0,"+("top"===d.orient()?27:4)+")").call(d);b.on("change.axis-"+h,function(){i.call(d),g||(g=d3.select(i.node().appendChild(i.selectAll("text").node().cloneNode(!0))).style("display","none").text(null))}),b.on("focus.axis-"+h,function(a){if(g)if(null==a)g.style("display","none"),i.selectAll("text").style("fill-opacity",null);else{g.style("display",null).attr("x",a).text(e(c.invert(a)));var b=g.node().getComputedTextLength()+6;i.selectAll("text").style("fill-opacity",function(d){return Math.abs(c(d)-a)<b?0:1})}})}var b=this,c=b.scale,d=d3.svg.axis().scale(c),e=b.step()<6e4?w:b.step()<864e5?x:y;return a.remove=function(a){function c(a){b.on("change.axis-"+a.id,null),b.on("focus.axis-"+a.id,null)}a.selectAll("svg").each(c).remove()},d3.rebind(a,d,"orient","ticks","tickSubdivide","tickSize","tickPadding","tickFormat")};var w=d3.time.format("%I:%M:%S %p"),x=d3.time.format("%I:%M %p"),y=d3.time.format("%B %d");p.rule=function(){function a(a){var b=++o,e=a.append("div").datum({id:b}).attr("class","line").call(l);a.each(function(b,e){function f(){for(var b=[],d=0,e=c.size();e>d;++d)i.valueAt(d)&&b.push(d);var f=a.selectAll(".metric").data(b);f.exit().remove(),f.enter().append("div").attr("class","metric line").call(l),f.style("left",m)}var g=this,h=++o,i="function"==typeof d?d.call(g,b,e):d;i&&(c.on("change.rule-"+h,f),i.on("change.rule-"+h,f))}),c.on("focus.rule-"+b,function(a){e.datum(a).style("display",null==a?"none":null).style("left",null==a?null:m)})}var c=this,d=b;return a.remove=function(a){function b(a){c.on("focus.rule-"+a.id,null)}a.selectAll(".line").each(b).remove()},a.metric=function(b){return arguments.length?(d=b,a):d},a}}(this);